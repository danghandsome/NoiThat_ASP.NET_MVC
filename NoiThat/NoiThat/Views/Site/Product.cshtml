@model PagedList.IPagedList<NoiThat.Models.ProductInfo>
@{
    ViewBag.Title = "Tất cả sản phẩm";
    Layout = "~/Views/Shared/_LayoutSite.cshtml";
}
@using PagedList.Mvc;
@using NoiThat.DAO;
@{ OrderDetailDAO orderDetailDAO = new OrderDetailDAO();}
@{ RateDAO rateDAO = new RateDAO();}



<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content padding-y">
    <div class="container">


        <!-- ============================  FILTER TOP  ================================= -->
        <div class="card mb-3">
            <div class="card-body">
                <ol class="breadcrumb float-left">
                    <li class="breadcrumb-item"><a href="@Url.Action("")">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Tất cả sản phẩm</a></li>
                </ol>
            </div> <!-- card-body .// -->
        </div> <!-- card.// -->
        <!-- ============================ FILTER TOP END.// ================================= -->


        <div class="row">
            <aside class="col-md-2">
                @Html.Action("ListCategory", "Module")

            </aside> <!-- col.// -->
            <main class="col-md-10">
                @foreach (var product in Model)
                {
                    <article class="card card-product-list">
                        <div class="row no-gutters">
                            <aside class="col-md-3">
                                <a href="~/@product.Slug" class="img-wrap">
                                    @{
                                        DateTime date = DateTime.Now;
                                    }
                                    @if (product.CreatedAt.Value.Day - date.Day <= 7)
                                    {
                                        <span class="badge badge-danger"> NEW</span>
                                    }
                                    <img class="img-sm float-right" src="~/Public/images/products/@product.Img">
                                </a>

                            </aside> <!-- col.// -->
                            <div class="col-md-6">
                                <div class="info-main">
                                    <a href="~/@product.Slug" class="h5 title"> @product.Name</a>
                                    @{ int sosao = (int)Math.Round(rateDAO.AvarageRate(product.id));
                                        if (sosao == 0)
                                        {
                                            <p>(Chưa có đánh giá)</p>
                                        }
                                        else
                                        {
                                            <ul class="rating-stars">
                                                <li style="width:100%" class="stars-active">
                                                    @for (int i = 1; i <= sosao; i++)
                                                    {
                                                        <i class="fa fa-star"></i>
                                                    }
                                                </li>
                                                <li>
                                                    <i class="fa fa-star"></i>
                                                    <i class="fa fa-star"></i>
                                                    <i class="fa fa-star"></i>
                                                    <i class="fa fa-star"></i>
                                                    <i class="fa fa-star"></i>
                                                </li>
                                            </ul>

                                        }}
                                    <p class="mb-3">
                                        @{ int soluotmua = orderDetailDAO.SoLuotMua(product.id);}
                                        <span class="tag"> <i class="fa fa-check"></i> Verified</span>
                                        <span class="tag"> @soluotmua người đã mua sản phẩm</span>
                                        <span class="tag"> @product.Material </span>
                                    </p>
                                    <p>
                                        @product.Detail
                                    </p>
                                </div> <!-- info-main.// -->
                            </div> <!-- col.// -->
                            <aside class="col-sm-3">
                                <div class="info-aside">
                                    <div class="price-wrap">
                                        <del>
                                            <span class="h5 pric text-danger">@string.Format("{0:0,0}", product.PriceSale)</span>
                                        </del>
                                        <small class="text-muted">đ</small>
                                    </div> <!-- price-wrap.// -->
                                    <div class="price-wrap">

                                        <span class="h5 pric text-danger">@string.Format("{0:0,0}", product.Price)</span>
                                        <small class="text-muted">đ</small>
                                    </div> <!-- price-wrap.// -->

                                    <p class="mt-3">
                                        <a href="@Url.Action("CartAdd","GioHang", new {productId=product.id})" class="btn btn-outline-primary"> <i class="fa fa-shopping-cart"></i> Thêm vào giỏ hàng </a>
                                    </p>



                                </div> <!-- info-aside.// -->
                            </aside> <!-- col.// -->
                        </div> <!-- row.// -->
                    </article> <!-- card-product .// -->
                }


                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-center">
                        @for (int i = 1; i <= ViewBag.Sotrang; i++)
                        {
                            <li class="page-item"><a class="page-link" href="~/Tat-ca-san-pham?page=@i">@i</a></li>

                        }
                    </ul>
                </nav>

            </main> <!-- col.// -->

        </div>

    </div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->
